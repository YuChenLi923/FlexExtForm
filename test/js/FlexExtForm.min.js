var Event={addListener:function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}else{a["on"+c]=b}}},getEvent:function(a){return a||window.event||arguments.callee.caller.arguments[0]},getTarget:function(a){return a.target||a.srcElement}};function getElement(d,h,a){var j=document,b=null,f=h.charAt(0);if(f==="#"){if(j.querySelector&&a==false){b=d.querySelector(h)}else{b=d.getElementById(h.slice(1))}}if(f==="."){if(j.querySelectorAll&&a==false){b=d.querySelectorAll(h)}else{if(j.getElementsByClassName){b=d.getElementsByClassName(h.slice(1))}else{var e=j.getElementsByTagName("*"),k=[];for(var c=0,g=e.length;c<g;c++){if(e[c].className==h.slice(1)){k.push(e[c])}}b=k}}}if(f!="."&&h.charAt(0)!="#"){if(j.querySelectorAll&&a==false){b=d.querySelectorAll(h)}else{b=d.getElementsByTagName(h)}}return b};var createForm=(function createForm(){var g={},c=null,l=document,n=null,f,a,i,h=null;function d(p,o){this.Id=p.ID;this.Type=p.Type;this.pattern=p.Pattern;this.input=getElement(l,"#"+p.ID,false);this.value=this.input.value;this.mask=0;this.flag=1;this.URL=o;this.ajax=p.Ajax}d.prototype={constructor:d,SayWarn:function(){this.value=this.input.value;if(this.value){if(this.pattern==" "||this.pattern.test(this.value)){n(0,this.Type);if(!this.ajax){this.flag=1}this.mask=1}else{n(10,this.Type);this.flag=0;this.mask=0}}else{n(11,this.Type);this.flag=0}},FormAjax:function(){var o=this.URL,p=this;ajaxExpanding.init({type:"get",async:"true",contentType:"text",accept:"text",charset:"utf-8"});if(this.mask==1){ajaxExpanding.send({url:o,data:{Value:this.value,Type:this.Id},onSuccess:function(r){var q=parseInt(r);if(q==0){n(13,p.Type);this.flag=0}else{n(14,p.Type);this.flag=1}},onFail:function(){n(2,p.Type)}},this);this.mask=0}},sameWarn:function(){if(this.Id.indexOf("repeat")==0){var o=getElement(l,"#"+this.Id.replace(/^repeat/,""),false);if(this.input.value!=o.value){n(12,this.Type);this.flag=0}else{n(0,this.Type)}}}};function b(){var q=0,p=0,o;j(f);m("Form",i,g,n)}function m(u,o,s,t,r){var q=document.getElementById(u),p=1;ajaxExpanding.init({type:"post",async:"true",contentType:"form",charset:"utf-8"});ajaxExpanding.send({url:o,data:q,onSuccess:function(w){var v=parseInt(w);f.innerHTML="提交数据";f.setAttribute("switch","on");if(v==1){n(4,this.Type)}else{n(3,this.Type)}},onError:function(){f.setAttribute("switch","on");f.innerHTML="提交";n(2,this.Type)}},this)}var e={click:function(){Event.addListener(f,"click",function(){if(f.getAttribute("switch")=="on"){b()}})},keydown:function(){Event.addListener(window,"keydown",function(o){var p=Event.getEvent(o);if(p.keyCode==13){b()}})},touch:function(){Event.addListener(f,"touchstart",function(){if(f.getAttribute("switch")=="on"){b()}})},change:function(){Event.addListener(a,"change",function(p){var p=Event.getEvent(p),q=Event.getTarget(p),o=q.name;if(g[o]){if(o.indexOf("repeat")==0){g[o].sameWarn()}g[o].SayWarn();if(g[o].ajax){g[o].FormAjax()}}})}};function k(p){for(var q=0,o=p.length;q<o;q++){e[p[q]]()}}function j(o){o.innerHTML="正在提交数据";o.setAttribute("switch","off")}return function(s,p,q,v,u){var o=s.length;i=u;for(var r=0;r<o;r++){var t=s[r];form=new d({ID:t.id,Type:t.type,Pattern:t.pattern,Ajax:t.ajax},i);g[t.id]=form}f=getElement(l,"#"+v+"_sumbit",true);a=getElement(l,"#"+v,true);f.setAttribute("switch","on");v=v;k(q);n=p;h=l.getElementById(v)}})();